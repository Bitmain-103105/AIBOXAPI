# 1.4 管理平台系统登录接口

**功能描述**

```text
    通过http协议或者https协议向远程云平台请求登录，获取token, MQ服务器连接参数配置。具体是走http协议，还是走https协议，由用户在配置SE3 AI迷你机时指定的管理平台URL前缘决定。
```

**请求地址**

```text
   通过SE3 AI 迷你机上的界面进行登录URL的填写。
```

**请求参数**

\*\*\*\*

| 参数 | 类型 | 选择 | 描述 |
| :--- | :--- | :--- | :--- |
| dev\_sno | string | 必选 | 通过SE3 AI 迷你机配置界面上进行配置，在请求URL时携带 |
| hex\_mac | string | 必选 | 上传到管理平台，告知管理平台dev\_sno授权码被SE3 AI 迷你机占用 |

```text
示例：
http://ip:port/login?dev_sno=xxxx
```

**管理平台返回值：**

请求成功：

| 一级参数 | 二级参数 | 四级参数 | 类型 | **选择** | 描述 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| token |  |  | string | **必选** | 请求云平台接口需要携带的参数 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| imgServerAddr |  |  | string | 可选 | 图片服务器URL，用于获取用户照片。如果下发得图片中是相对路径，则需要填写此地址。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


<table>
  <thead>
    <tr>
      <th style="text-align:left">recordAddr</th>
      <th style="text-align:left"></th>
      <th style="text-align:left"></th>
      <th style="text-align:left">string</th>
      <th style="text-align:left">&#x53EF;&#x9009;</th>
      <th style="text-align:left">
        <p>&#x7BA1;&#x7406;&#x5E73;&#x53F0;URL&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x4E2A;URL&#xFF08;&#x53EF;&#x4EE5;&#x4E3A;&#x7EDD;&#x5BF9;&#x5730;&#x5740;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x76F8;&#x5BF9;&#x5730;&#x5740;&#xFF09;&#x95F4;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#x3002;</p>
        <p>&#x7528;&#x4E8E;&#x63A5;&#x6536;&#x201C;&#x4EBA;&#x5458;&#x901A;&#x884C;&#x8BB0;&#x5F55;&#x201D;&#x3002;
          &#x5982;&#xFF1A;</p>
        <p>&#x793A;&#x4F8B;1&#xFF1A;&quot;/getRecord , /getRecord2&quot;,</p>
        <p>&#x793A;&#x4F8B;2&#xFF1A;&quot;/getRecord , https://xxxx.com/getBackupRecord&quot;</p>
        <p>&#x793A;&#x4F8B;3&#xFF1A;&quot;<a href="http://xxx.com/getRecord,">http://xxx.com/getRecord,</a> 
          <a
          href="http://xxx.com/">http://xxx.com</a>/getBackupRecord&quot;</p>
      </th>
    </tr>
  </thead>
  <tbody></tbody>
</table>| recordUploadPeriod |  |  | int | 可选 | 通行记录周期上传时间，大于等于1秒，默认值为5秒 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| deviceInfoAddr |  |  | string | 可选 | 管理平台URL（相对地址），用于接收“设备添加事件”。如：/getDeviceInfo |
| :--- | :--- | :--- | :--- | :--- | :--- |


| deviceMonitorAddr |  |  | string | 可选 | 管理平台URL（相对地址），用于接收“设备状态上报信息”。如：/deviceMonitor |
| :--- | :--- | :--- | :--- | :--- | :--- |


| deviceMonitorPeriod |  |  | int | 可选 | 管理平台URL \(相对地址\) ， 用于设置设备状态上报得周期，默认20秒 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq |  |  | dict |  | MQ服务器配置参数集合 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | host |  | string |  | MQ服务器地址, 如 mq.xxx.com |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | port |  | int |  | MQ服务器连接端口 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | login |  | string |  | MQ服务器登录用户名 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | password |  | string |  | MQ服务器连接密码 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | queue |  | string |  | MQ消息下发队列 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | vHost |  | string | 可选 | MQ服务器登录用户名及下发队列所在虚拟主机.如果不指定，默认为"/"。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | uploadVHost |  | string | 可选 | MQ服务器上报队列所在虚拟主机。如果不指定，默认为"/"。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| rabbitmq | uploadQueue |  | string | 可选 | MQ消息上传队列, 可以选择不通过MQ消息队列回传结果, 在uploadVHost虚拟主机下。默认是不支持MQ消息上传（即单向通信）。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


<table>
  <thead>
    <tr>
      <th style="text-align:left">rabbitmq</th>
      <th style="text-align:left">fiqaDownQueue</th>
      <th style="text-align:left"></th>
      <th style="text-align:left">string</th>
      <th style="text-align:left">&#x53EF;&#x9009;</th>
      <th style="text-align:left">
        <p>&#x4EBA;&#x8138;&#x56FE;&#x7247;&#x8D28;&#x91CF;&#x68C0;&#x6D4B;(FIQA)&#x547D;&#x4EE4;&#x4E0B;&#x53D1;&#x961F;&#x5217;&#x3002;</p>
        <p>&#x6CE8;&#x610F;&#xFF1A;&#x5F53;&#x628A;SE3 AI&#x8FF7;&#x4F60;&#x673A;&#x7528;&#x4F5C;&#x56FE;&#x7247;&#x8D28;&#x91CF;&#x6821;&#x9A8C;&#x670D;&#x52A1;&#x5668;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x4E0B;&#x53D1;&#x6B64;&#x680F;&#x4F4D;&#x3002;&#x5426;&#x5219;&#x4E0D;&#x652F;&#x6301;&#x901A;&#x8FC7;MQ&#x547D;&#x4EE4;&#x8FDB;&#x884C;FIQA&#x6821;&#x9A8C;&#x529F;&#x80FD;&#x3002;</p>
      </th>
    </tr>
  </thead>
  <tbody></tbody>
</table><table>
  <thead>
    <tr>
      <th style="text-align:left">rabbitmq</th>
      <th style="text-align:left">fiqaUploadQueue</th>
      <th style="text-align:left"></th>
      <th style="text-align:left">string</th>
      <th style="text-align:left">&#x53EF;&#x9009;</th>
      <th style="text-align:left">
        <p>&#x4EBA;&#x8138;&#x56FE;&#x7247;&#x8D28;&#x91CF;&#x68C0;&#x6D4B;(FIQA)&#x547D;&#x4EE4;&#x7ED3;&#x679C;&#x4E0A;&#x4F20;&#x961F;&#x5217;&#x3002;</p>
        <p>&#x6CE8;&#x610F;&#xFF1A;&#x5F53;&#x628A;SE3 AI&#x8FF7;&#x4F60;&#x673A;&#x7528;&#x4F5C;&#x56FE;&#x7247;&#x8D28;&#x91CF;&#x6821;&#x9A8C;&#x670D;&#x52A1;&#x5668;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x4E0B;&#x53D1;&#x6B64;&#x680F;&#x4F4D;&#x3002;&#x5426;&#x5219;&#x4E0D;&#x652F;&#x6301;&#x901A;&#x8FC7;MQ&#x547D;&#x4EE4;&#x8FDB;&#x884C;FIQA&#x6821;&#x9A8C;&#x529F;&#x80FD;&#x3002;</p>
      </th>
    </tr>
  </thead>
  <tbody></tbody>
</table>| rabbitmq | unNeedBindExchange |  | bool | 可选 | 消息队列是否需要绑定到交换机， 默认为false， 即需要绑定到消息队列。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange |  | dict | **必选** |  |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | name | string | **必选** | 交换机名称 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | type | string | **必选** | 交换机类型 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | passive | bool | **必选** | 检查交换机是否存在，默认为false |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | durable | bool | **必选** | 队列持久化标志，true为持久化队列 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | auto\_delete | bool | **必选** | 自动删除 |
| :--- | :--- | :--- | :--- | :--- | :--- |


| arguments | exchange | dict | 必选 | 扩展参数 |  |
| :--- | :--- | :--- | :--- | :--- | :--- |


|  | ....... |  | 自定义 | 可选 | 保留将来用于下发MQ服务器其它配置信息。 |
| :--- | :--- | :--- | :--- | :--- | :--- |


```text
示例：

{ 

     "token":"xxxx",
     "rabbitmq":{
              "host":"120.65.13.58",
              "port":"5672",
              "login":"admin",
              "password":"admin",
              "queue":"2806BF52CEDE407C8ABBA55CD35C8FEF",
              "exchange":{
                    "name":"exchangename1",
                    "type":"topic",
                    "passive":false,
                    "durable":true,
                    "auto_delete":false,
                    "arguments":null
                    }
          }
}
```

请求失败：

如果http返回状态码不为 200，则认为本次登录请求失败。

| **一级参数** | **二级参数** | **类型** | **描述** |
| :--- | :--- | :--- | :--- |
| error | code | int | 请求错误码 |
|  | message | string | 错误描述 |
|  | status | string | 错误类型 |

